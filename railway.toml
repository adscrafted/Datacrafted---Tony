# Railway Configuration
# This file configures how Railway builds and deploys the application

[build]
# Use Dockerfile for building
builder = "dockerfile"
# Path to Dockerfile
dockerfilePath = "Dockerfile"

# Pass environment variables as build arguments
# These are required for NEXT_PUBLIC_* variables to be baked into the client bundle
[build.args]
NEXT_PUBLIC_FIREBASE_API_KEY = "${{NEXT_PUBLIC_FIREBASE_API_KEY}}"
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN = "${{NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN}}"
NEXT_PUBLIC_FIREBASE_PROJECT_ID = "${{NEXT_PUBLIC_FIREBASE_PROJECT_ID}}"
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET = "${{NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET}}"
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID = "${{NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID}}"
NEXT_PUBLIC_FIREBASE_APP_ID = "${{NEXT_PUBLIC_FIREBASE_APP_ID}}"
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID = "${{NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID}}"
NEXT_PUBLIC_APP_URL = "${{NEXT_PUBLIC_APP_URL}}"
NEXT_PUBLIC_ENABLE_AI_ANALYSIS = "${{NEXT_PUBLIC_ENABLE_AI_ANALYSIS}}"
NEXT_PUBLIC_ENABLE_EXPORT = "${{NEXT_PUBLIC_ENABLE_EXPORT}}"
NEXT_PUBLIC_MAX_FILE_SIZE_MB = "${{NEXT_PUBLIC_MAX_FILE_SIZE_MB}}"
NEXT_PUBLIC_MAX_ROWS = "${{NEXT_PUBLIC_MAX_ROWS}}"

[deploy]
# Number of replicas
numReplicas = 1
# Health check path
healthcheckPath = "/api/health"
# Health check timeout
healthcheckTimeout = 300
# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
